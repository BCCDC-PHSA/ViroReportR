<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Respiratory Viral Infection Forecast Reporting â€¢ ViroReportR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Respiratory Viral Infection Forecast Reporting">
<meta name="description" content="Tools for reporting and forecasting viral respiratory infections, using case surveillance data. Report generation tools for short-term forecasts, and validation metrics for an arbitrary number of customizable respiratory viruses. Estimation of the effective reproduction number is based on the EpiEstim framework described in work by Cori and colleagues. (2013) &lt;doi:10.1093/aje/kwt133&gt;.">
<meta property="og:description" content="Tools for reporting and forecasting viral respiratory infections, using case surveillance data. Report generation tools for short-term forecasts, and validation metrics for an arbitrary number of customizable respiratory viruses. Estimation of the effective reproduction number is based on the EpiEstim framework described in work by Cori and colleagues. (2013) &lt;doi:10.1093/aje/kwt133&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ViroReportR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.4.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/vriforecasting-model-fitting-epiestim.html">Model fitting and producing short-term forecasts using daily data with EpiEstim</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BCCDC-PHSA/ViroReportR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="viroreportr-">ViroReportR <img src="package_logo/hex_logo.png" align="right" height="139" alt=""><a class="anchor" aria-label="anchor" href="#viroreportr-"></a>
</h1></div>
<!-- badges: start -->

<p>ðŸ“˜ <strong>Documentation website:</strong><br><a href="https://bccdc-phsa.github.io/ViroReportR/" class="uri">https://bccdc-phsa.github.io/ViroReportR/</a></p>
<p>The goal of <code>ViroReportR</code> is to provide a toolbox to conveniently generate short-term forecasts (with accompanied diagnostics) for viral respiratory diseases.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="cran-recommended">CRAN (recommended)<a class="anchor" aria-label="anchor" href="#cran-recommended"></a>
</h3>
<p>Install the released version from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ViroReportR"</span><span class="op">)</span></span></code></pre></div>
<p>You can then install the development version of <code>ViroReportR</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"BCCDC-PHSA/ViroReportR"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p><code>ViroReportR</code> can be used to generate short-term forecasts with accompanied diagnostics in a few lines of code. We go through an example here where the <code>EpiEstim</code> backend is used to generate forecasts of Influenza-A, RSV and SARS-CoV-2.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BCCDC-PHSA/ViroReportR" class="external-link">ViroReportR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€</span></span>
<span><span class="co">#&gt; âœ” dplyr     1.1.4     âœ” readr     2.1.5</span></span>
<span><span class="co">#&gt; âœ” forcats   1.0.0     âœ” stringr   1.6.0</span></span>
<span><span class="co">#&gt; âœ” ggplot2   4.0.0     âœ” tibble    3.2.1</span></span>
<span><span class="co">#&gt; âœ” lubridate 1.9.4     âœ” tidyr     1.3.1</span></span>
<span><span class="co">#&gt; âœ” purrr     1.0.2     </span></span>
<span><span class="co">#&gt; â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€</span></span>
<span><span class="co">#&gt; âœ– dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; âœ– dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; here() starts at C:/Users/rebeca.falcao/ViroReportR</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kableExtra'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     group_rows</span></span></code></pre></div>
<p>We will use <code>simulate_data</code> to simulate date for Influenza A, RSV, and SARS-CoV-2, which is included with the <code>ViroReportR</code> package. We then pivot the simulated data to transform into a dataset with three columns: <code>date</code>, <code>disease_type</code> and <code>confirm</code> in accordance to format accepted by the model fitting functions.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diseases</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"flu_a"</span>, <span class="st">"rsv"</span>, <span class="st">"sars_cov2"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_data.html">simulate_data</a></span><span class="op">(</span>days<span class="op">=</span><span class="fl">365</span>, <span class="co">#days spanning simulation</span></span>
<span>                      peaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"flu_a"</span><span class="op">=</span><span class="fl">90</span>,<span class="st">"rsv"</span><span class="op">=</span><span class="fl">110</span>,<span class="st">"sars_cov2"</span><span class="op">=</span><span class="fl">160</span><span class="op">)</span>, <span class="co">#peak day for each disease</span></span>
<span>                      amplitudes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"flu_a"</span><span class="op">=</span><span class="fl">50</span>,<span class="st">"rsv"</span><span class="op">=</span><span class="fl">40</span>,<span class="st">"sars_cov2"</span><span class="op">=</span><span class="fl">20</span><span class="op">)</span>, <span class="co">#amplitude of peak for each disease</span></span>
<span>                      scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"flu_a"</span><span class="op">=</span><span class="op">-</span><span class="fl">0.004</span>,<span class="st">"rsv"</span><span class="op">=</span><span class="op">-</span><span class="fl">0.005</span>,<span class="st">"sars_cov2"</span><span class="op">=</span><span class="op">-</span><span class="fl">0.001</span><span class="op">)</span>, <span class="co"># spread of peak for each disease</span></span>
<span>                      time_offset <span class="op">=</span> <span class="fl">0</span>, <span class="co">#number of days to offset start of simulation</span></span>
<span>                      noise_sd <span class="op">=</span> <span class="fl">5</span>, <span class="co">#noise term</span></span>
<span>                      start_date <span class="op">=</span> <span class="st">"2024-01-07"</span> <span class="co">#starting day (Sunday)</span></span>
<span>                      <span class="op">)</span></span>
<span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vri_data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">diseases</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">diseases</span>,<span class="op">~</span> <span class="fu"><a href="reference/get_aggregated_data.html">get_aggregated_data</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">"date"</span>, <span class="va">.y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="va">diseases</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">vri_data_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; $flu_a</span></span>
<span><span class="co">#&gt; # A tibble: 366 Ã— 2</span></span>
<span><span class="co">#&gt;    date       confirm</span></span>
<span><span class="co">#&gt;    &lt;date&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2024-01-07       1</span></span>
<span><span class="co">#&gt;  2 2024-01-08       0</span></span>
<span><span class="co">#&gt;  3 2024-01-09       3</span></span>
<span><span class="co">#&gt;  4 2024-01-10       3</span></span>
<span><span class="co">#&gt;  5 2024-01-11       0</span></span>
<span><span class="co">#&gt;  6 2024-01-12       0</span></span>
<span><span class="co">#&gt;  7 2024-01-13       6</span></span>
<span><span class="co">#&gt;  8 2024-01-14       0</span></span>
<span><span class="co">#&gt;  9 2024-01-15       0</span></span>
<span><span class="co">#&gt; 10 2024-01-16       1</span></span>
<span><span class="co">#&gt; # â„¹ 356 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rsv</span></span>
<span><span class="co">#&gt; # A tibble: 366 Ã— 2</span></span>
<span><span class="co">#&gt;    date       confirm</span></span>
<span><span class="co">#&gt;    &lt;date&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2024-01-07       0</span></span>
<span><span class="co">#&gt;  2 2024-01-08       5</span></span>
<span><span class="co">#&gt;  3 2024-01-09       0</span></span>
<span><span class="co">#&gt;  4 2024-01-10       0</span></span>
<span><span class="co">#&gt;  5 2024-01-11       0</span></span>
<span><span class="co">#&gt;  6 2024-01-12       0</span></span>
<span><span class="co">#&gt;  7 2024-01-13       6</span></span>
<span><span class="co">#&gt;  8 2024-01-14       8</span></span>
<span><span class="co">#&gt;  9 2024-01-15       0</span></span>
<span><span class="co">#&gt; 10 2024-01-16       0</span></span>
<span><span class="co">#&gt; # â„¹ 356 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sars_cov2</span></span>
<span><span class="co">#&gt; # A tibble: 366 Ã— 2</span></span>
<span><span class="co">#&gt;    date       confirm</span></span>
<span><span class="co">#&gt;    &lt;date&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2024-01-07       0</span></span>
<span><span class="co">#&gt;  2 2024-01-08       2</span></span>
<span><span class="co">#&gt;  3 2024-01-09       0</span></span>
<span><span class="co">#&gt;  4 2024-01-10       4</span></span>
<span><span class="co">#&gt;  5 2024-01-11       1</span></span>
<span><span class="co">#&gt;  6 2024-01-12       1</span></span>
<span><span class="co">#&gt;  7 2024-01-13       3</span></span>
<span><span class="co">#&gt;  8 2024-01-14       4</span></span>
<span><span class="co">#&gt;  9 2024-01-15       0</span></span>
<span><span class="co">#&gt; 10 2024-01-16       2</span></span>
<span><span class="co">#&gt; # â„¹ 356 more rows</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-fitting-and-forecasting">Model fitting and forecasting<a class="anchor" aria-label="anchor" href="#model-fitting-and-forecasting"></a>
</h2>
<p>The code below estimates the reproduction number using <code>EpiEstim</code> through the <code><a href="reference/generate_forecast.html">generate_forecast()</a></code> function for each disease type via the <code><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">purrr::map2()</a></code> function. The <code><a href="reference/generate_forecast.html">generate_forecast()</a></code> function prepares the data, estimates the reproduction number, and produces short-term forecasts of daily confirmed cases for an <code>n_days</code> forecast horizon. The other current choice for the forecasting algorithm is <code>EpiFilter</code> (WIP).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># parameters set-up </span></span>
<span><span class="va">start_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">13</span></span>
<span><span class="va">n_days</span> <span class="op">&lt;-</span> <span class="fl">14</span> <span class="co"># number of days ahead to forecast (n_days)</span></span>
<span><span class="va">smooth</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># logical indicating whether smoothing should be applied in the forecast</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecasts_results</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  <span class="va">vri_data_list</span>,</span>
<span>  forecasts <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>    <span class="va">vri_data_list</span>,</span>
<span>    <span class="va">diseases</span>,</span>
<span>    <span class="op">~</span> <span class="fu"><a href="reference/generate_forecast.html">generate_forecast</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">.x</span>,</span>
<span>      smooth_data <span class="op">=</span> <span class="va">smooth</span>,</span>
<span>      type <span class="op">=</span> <span class="va">.y</span>,</span>
<span>      n_days <span class="op">=</span> <span class="va">n_days</span>,</span>
<span>      start_date <span class="op">=</span> <span class="va">start_date</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">forecasts_results</span><span class="op">$</span><span class="va">forecasts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">diseases</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">forecasts_results</span><span class="op">$</span><span class="va">vri_data_list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">diseases</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting-results">Plotting results<a class="anchor" aria-label="anchor" href="#plotting-results"></a>
</h2>
<p>The code below plots the forecasts results and the estimated <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math> for each disease. To plot <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>t</mi></msub><annotation encoding="application/x-tex">R_t</annotation></semantics></math>, the code below uses <code>plot_rt</code> function included in the package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">vri</span> <span class="kw">in</span> <span class="va">diseases</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">forecast_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">forecasts_results</span><span class="op">$</span><span class="va">forecasts</span><span class="op">[[</span><span class="va">vri</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"forecast_res_quantiles"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, ymin <span class="op">=</span> <span class="va">p10</span>, ymax <span class="op">=</span> <span class="va">p90</span>, fill <span class="op">=</span> <span class="st">"Prediction Interval"</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.4</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">forecasts_results</span><span class="op">$</span><span class="va">forecasts</span><span class="op">[[</span><span class="va">vri</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"forecast_res_quantiles"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">p50</span>, color <span class="op">=</span> <span class="st">"Median Forecast"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">forecasts_results</span><span class="op">$</span><span class="va">vri_data_list</span><span class="op">[[</span><span class="va">vri</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">confirm</span>, shape <span class="op">=</span> <span class="st">"Positive Tests"</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span>  <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">n_days</span>, <span class="st">"-Day Forecast of Daily "</span>, <span class="va">vri</span>, <span class="st">" Positive Tests"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Predicted Tests"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">""</span>, color <span class="op">=</span> <span class="st">""</span>, shape <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prediction Interval"</span> <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Median Forecast"</span> <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive Tests"</span> <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>, legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># create Rt plot</span></span>
<span>  <span class="va">rt_plot</span> <span class="op">&lt;-</span> <span class="fu">ViroReportR</span><span class="fu">:::</span><span class="fu"><a href="reference/plot_rt.html">plot_rt</a></span><span class="op">(</span><span class="va">forecasts_results</span><span class="op">$</span><span class="va">forecasts</span><span class="op">[[</span><span class="va">vri</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">forecast_plot</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rt_plot</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="reference/figures/README-plotting-1.png" width="100%"><img src="reference/figures/README-plotting-2.png" width="100%"><img src="reference/figures/README-plotting-3.png" width="100%"><img src="reference/figures/README-plotting-4.png" width="100%"><img src="reference/figures/README-plotting-5.png" width="100%"><img src="reference/figures/README-plotting-6.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="forecast-report">Forecast report<a class="anchor" aria-label="anchor" href="#forecast-report"></a>
</h2>
<p>Finally, the <code>ViroReportR</code> package can generate an automated report for the current season across all supported respiratory viruses (Influenza A, RSV, and SARS-CoV-2) using the <code><a href="reference/generate_forecast_report.html">generate_forecast_report()</a></code> function. This function renders an HTML report summarizing model outputs and forecasts.</p>
<p>To use it, provide an input file (<code>input_file</code>) containing the required data with three columnsâ€”date, disease_type, and confirmâ€”and specify an output directory (<code>output_directory)</code> where the report will be saved.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># rendering forecast report</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">imap_dfr</a></span><span class="op">(</span><span class="va">vri_data_list</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">mutate</span><span class="op">(</span>disease_type <span class="op">=</span> <span class="va">.y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">input_file</span><span class="op">&lt;-</span><span class="st">"simulated_data.csv"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">input_file</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/generate_forecast_report.html">generate_forecast_report</a></span><span class="op">(</span></span>
<span>  input_data_dir <span class="op">=</span>  <span class="va">input_file</span>, <span class="co"># input filepath</span></span>
<span>  output_dir <span class="op">=</span> <span class="va">output_directory</span>, <span class="co"># output directory</span></span>
<span>  n_days <span class="op">=</span> <span class="fl">14</span>, <span class="co"># number of days to forecast</span></span>
<span>  validate_window_size <span class="op">=</span> <span class="fl">7</span>, <span class="co"># number of days between each validation window</span></span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># logical indicating whether smoothing should be applied in the forecast</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ViroReportR" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/BCCDC-PHSA/ViroReportR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/BCCDC-PHSA/ViroReportR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ViroReportR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Mike Irvine <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
<li>Caesar Wong <br><small class="roles"> Author </small>   </li>
<li>Nirupama Tamvada <br><small class="roles"> Author </small>   </li>
<li>Rebeca Falcao <br><small class="roles"> Author </small>   </li>
<li>Nelson Tang <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://CRAN.R-project.org/package=ViroReportR" class="external-link"><img src="https://www.r-pkg.org/badges/version/ViroReportR" alt="CRAN status"></a></li>
<li><a href="https://github.com/BCCDC-PHSA/ViroReportR/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/BCCDC-PHSA/ViroReportR/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://bccdc-phsa.github.io/ViroReportR/"><img src="https://github.com/BCCDC-PHSA/ViroReportR/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mike Irvine, Caesar Wong, Nirupama Tamvada, Rebeca Falcao, Nelson Tang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
