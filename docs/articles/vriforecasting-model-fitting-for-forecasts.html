<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model fitting and producing short-term forecasts using weekly data • vriforecasting</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Model fitting and producing short-term forecasts using weekly data">
<meta property="og:description" content="vriforecasting">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vriforecasting</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vriforecasting-model-fitting-for-forecasts.html">Model fitting and producing short-term forecasts using weekly data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Model fitting and producing short-term forecasts
using weekly data</h1>
            
      
      
      <div class="hidden name"><code>vriforecasting-model-fitting-for-forecasts.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">vriforecasting</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides a short demonstration of the model fitting
functions in <code>vriforecasting</code> which extend the functionality
and wrap the <code>estimate_R</code> function from the
<code>EpiEstim</code> package to produce short-term forecasts.</p>
</div>
<div class="section level2">
<h2 id="loading-in-data">Loading in data<a class="anchor" aria-label="anchor" href="#loading-in-data"></a>
</h2>
<p>For this short demonstration, we will use the PLOVER weekly data for
Influenza A, which is provided with the <code>vriforecasting</code>
package. We then use the <code>get_weekly_plover</code> and
<code>get_weekly_plover_by_date_type</code> functions to transform the
PLOVER data into a dataset with two columns: <code>date</code> and
<code>confirm</code> in accordance to format accepted by the model
fitting functions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">weekly_plover_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_weekly_plover.html">get_weekly_plover</a></span><span class="op">(</span><span class="va">plover_data</span><span class="op">)</span>

<span class="va">disease_type</span> <span class="op">&lt;-</span> <span class="st">"flu_a"</span>
<span class="va">weekly_plover_date_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_weekly_plover_by_date_type.html">get_weekly_plover_by_date_type</a></span><span class="op">(</span>
  weekly_plover_data <span class="op">=</span> <span class="va">weekly_plover_data</span>,
  type <span class="op">=</span> <span class="va">disease_type</span>,
  start_date <span class="op">=</span> <span class="st">"2022-10-01"</span>,
  end_date <span class="op">=</span> <span class="st">"2022-12-01"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">weekly_plover_date_type</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span>
<span class="co">#&gt;   date       confirm</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2022-10-02      17</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2022-10-09      19</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2022-10-16      32</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2022-10-23      38</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2022-10-30      43</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2022-11-06      45</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p>The model to estimate the reproduction number using
<code>EpiEstim</code> can be fit using the
<code>fit_epiestim_model</code> function as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_epiestim_model.html">fit_epiestim_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">weekly_plover_date_type</span>, type <span class="op">=</span> <span class="st">"flu_a"</span><span class="op">)</span>
<span class="co">#&gt; Estimated R for iteration: 1</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 1</span>
<span class="co">#&gt; Estimated R for iteration: 2</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 2</span>
<span class="co">#&gt; Estimated R for iteration: 3</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 3</span>
<span class="co">#&gt; Estimated R for iteration: 4</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 4</span>
<span class="co">#&gt; Estimated R for iteration: 5</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 5</span>
<span class="co">#&gt; Estimated R for iteration: 6</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 6</span>
<span class="co">#&gt; Estimated R for iteration: 7</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 7</span>
<span class="co">#&gt; Estimated R for iteration: 8</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 8</span>
<span class="co">#&gt; Estimated R for iteration: 9</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 9</span>
<span class="co">#&gt; Estimated R for iteration: 10</span>
<span class="co">#&gt; Reconstructed incidence for iteration: 10</span>
<span class="co">#&gt; R estimation starts on day 8</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mod_fit</span><span class="op">)</span>
<span class="co">#&gt; $R</span>
<span class="co">#&gt;    t_start t_end  Mean(R)    Std(R) Quantile.0.025(R) Quantile.0.05(R)</span>
<span class="co">#&gt; 1        8    14 1.152583 0.2403301         0.7306384        0.7877399</span>
<span class="co">#&gt; 2        9    15 1.180219 0.2411041         0.7558886        0.8135439</span>
<span class="co">#&gt; 3       10    16 1.214957 0.2422085         0.7874804        0.8458341</span>
<span class="co">#&gt; 4       11    17 1.247874 0.2418035         0.8197549        0.8785024</span>
<span class="co">#&gt; 5       12    18 1.277499 0.2396764         0.8516633        0.9104323</span>
<span class="co">#&gt; 6       13    19 1.304243 0.2360330         0.8833089        0.9417571</span>
<span class="co">#&gt; 7       14    20 1.328500 0.2310987         0.9147423        0.9725622</span>
<span class="co">#&gt; 8       15    21 1.350409 0.2250681         0.9458096        1.0027222</span>
<span class="co">#&gt; 9       16    22 1.309985 0.2132907         0.9257392        0.9799750</span>
<span class="co">#&gt; 10      17    23 1.259935 0.2011878         0.8968637        0.9482540</span>
<span class="co">#&gt; 11      18    24 1.216296 0.1912229         0.8707381        0.9197563</span>
<span class="co">#&gt; 12      19    25 1.178977 0.1832342         0.8475275        0.8946192</span>
<span class="co">#&gt; 13      20    26 1.145249 0.1767090         0.8254062        0.8708937</span>
<span class="co">#&gt; 14      21    27 1.112884 0.1712722         0.8028141        0.8469272</span>
<span class="co">#&gt; 15      22    28 1.080222 0.1666819         0.7785291        0.8214352</span>
<span class="co">#&gt; 16      23    29 1.077261 0.1652021         0.7780906        0.8206735</span>
<span class="co">#&gt; 17      24    30 1.082617 0.1649014         0.7838210        0.8263893</span>
<span class="co">#&gt; 18      25    31 1.088795 0.1646199         0.7903256        0.8328894</span>
<span class="co">#&gt; 19      26    32 1.094132 0.1641046         0.7963993        0.8389028</span>
<span class="co">#&gt; 20      27    33 1.098675 0.1633661         0.8020729        0.8444631</span>
<span class="co">#&gt; 21      28    34 1.102700 0.1624489         0.8075412        0.8497756</span>
<span class="co">#&gt; 22      29    35 1.106416 0.1613874         0.8129530        0.8549980</span>
<span class="co">#&gt; 23      30    36 1.099570 0.1594524         0.8094910        0.8510820</span>
<span class="co">#&gt; 24      31    37 1.090549 0.1573650         0.8041551        0.8452431</span>
<span class="co">#&gt; 25      32    38 1.081983 0.1555053         0.7988855        0.8395211</span>
<span class="co">#&gt; 26      33    39 1.074161 0.1539123         0.7938967        0.8341407</span>
<span class="co">#&gt; 27      34    40 1.066818 0.1525474         0.7889942        0.8288979</span>
<span class="co">#&gt; 28      35    41 1.059697 0.1513755         0.7839861        0.8235913</span>
<span class="co">#&gt; 29      36    42 1.052619 0.1503742         0.7787336        0.8180763</span>
<span class="co">#&gt; 30      37    43 1.084371 0.1522882         0.8066341        0.8466136</span>
<span class="co">#&gt; 31      38    44 1.126854 0.1547230         0.8441959        0.8849937</span>
<span class="co">#&gt; 32      39    45 1.169883 0.1562043         0.8839340        0.9253410</span>
<span class="co">#&gt; 33      40    46 1.210597 0.1563855         0.9236451        0.9653514</span>
<span class="co">#&gt; 34      41    47 1.248342 0.1552866         0.9626735        1.0043622</span>
<span class="co">#&gt; 35      42    48 1.282760 0.1530099         1.0005086        1.0418761</span>
<span class="co">#&gt; 36      43    49 1.313493 0.1496865         1.0365885        1.0773533</span>
<span class="co">#&gt; 37      44    50 1.279843 0.1421529         1.0164706        1.0553365</span>
<span class="co">#&gt; 38      45    51 1.233764 0.1341348         0.9849373        1.0217282</span>
<span class="co">#&gt; 39      46    52 1.192199 0.1274060         0.9556226        0.9906557</span>
<span class="co">#&gt; 40      47    53 1.156109 0.1219548         0.9294899        0.9630867</span>
<span class="co">#&gt; 41      48    54 1.123399 0.1174836         0.9049832        0.9373879</span>
<span class="co">#&gt; 42      49    55 1.092181 0.1137574         0.8806461        0.9120410</span>
<span class="co">#&gt; 43      50    56 1.061005 0.1106174         0.8553199        0.8858440</span>
<span class="co">#&gt; 44      51    57 1.053270 0.1092393         0.8500896        0.8802555</span>
<span class="co">#&gt; 45      52    58 1.052291 0.1085947         0.8502538        0.8802626</span>
<span class="co">#&gt; 46      53    59 1.052210 0.1080716         0.8510949        0.8809788</span>
<span class="co">#&gt; 47      54    60 1.051666 0.1075289         0.8515115        0.8812639</span>
<span class="co">#&gt; 48      55    61 1.050628 0.1069641         0.8514791        0.8810926</span>
<span class="co">#&gt; 49      56    62 1.049264 0.1063948         0.8511328        0.8806049</span>
<span class="co">#&gt; 50      57    63 1.047714 0.1058351         0.8505852        0.8799175</span>
<span class="co">#&gt;    Quantile.0.25(R) Median(R) Quantile.0.75(R) Quantile.0.95(R)</span>
<span class="co">#&gt; 1         0.9826946  1.135922         1.304327         1.574268</span>
<span class="co">#&gt; 2         1.0099151  1.163842         1.332687         1.602769</span>
<span class="co">#&gt; 3         1.0440288  1.198900         1.368398         1.638862</span>
<span class="co">#&gt; 4         1.0774095  1.232291         1.401367         1.670412</span>
<span class="co">#&gt; 5         1.1087301  1.262542         1.429976         1.695595</span>
<span class="co">#&gt; 6         1.1382506  1.290032         1.454756         1.715210</span>
<span class="co">#&gt; 7         1.1661993  1.315124         1.476229         1.730071</span>
<span class="co">#&gt; 8         1.1925706  1.337926         1.494648         1.740682</span>
<span class="co">#&gt; 9         1.1605211  1.298427         1.446858         1.679424</span>
<span class="co">#&gt; 10        1.1190414  1.249243         1.389180         1.608094</span>
<span class="co">#&gt; 11        1.0824471  1.206289         1.339242         1.546972</span>
<span class="co">#&gt; 12        1.0507670  1.169498         1.296859         1.495672</span>
<span class="co">#&gt; 13        1.0216333  1.136174         1.258977         1.450566</span>
<span class="co">#&gt; 14        0.9930814  1.104111         1.223128         1.408773</span>
<span class="co">#&gt; 15        0.9636205  1.071661         1.187497         1.368215</span>
<span class="co">#&gt; 16        0.9617172  1.068828         1.183618         1.362618</span>
<span class="co">#&gt; 17        0.9673077  1.074256         1.188817         1.367368</span>
<span class="co">#&gt; 18        0.9737093  1.080510         1.194854         1.372966</span>
<span class="co">#&gt; 19        0.9794345  1.085938         1.199902         1.377312</span>
<span class="co">#&gt; 20        0.9845247  1.090589         1.204015         1.380475</span>
<span class="co">#&gt; 21        0.9892225  1.094733         1.207497         1.382804</span>
<span class="co">#&gt; 22        0.9937141  1.098579         1.210579         1.384570</span>
<span class="co">#&gt; 23        0.9882392  1.091873         1.202514         1.374320</span>
<span class="co">#&gt; 24        0.9806912  1.082989         1.192169         1.361644</span>
<span class="co">#&gt; 25        0.9734373  1.074543         1.182422         1.349829</span>
<span class="co">#&gt; 26        0.9667367  1.066819         1.173585         1.339229</span>
<span class="co">#&gt; 27        0.9603523  1.059555         1.165370         1.329512</span>
<span class="co">#&gt; 28        0.9540528  1.052498         1.157497         1.320362</span>
<span class="co">#&gt; 29        0.9476737  1.045467         1.149772         1.311561</span>
<span class="co">#&gt; 30        0.9781434  1.077250         1.182840         1.346420</span>
<span class="co">#&gt; 31        1.0189987  1.119780         1.227001         1.392844</span>
<span class="co">#&gt; 32        1.0610825  1.162938         1.271115         1.438116</span>
<span class="co">#&gt; 33        1.1017710  1.203869         1.312091         1.478791</span>
<span class="co">#&gt; 34        1.1403929  1.241909         1.349282         1.514268</span>
<span class="co">#&gt; 35        1.1765116  1.276682         1.382385         1.544381</span>
<span class="co">#&gt; 36        1.2096740  1.307812         1.411121         1.569016</span>
<span class="co">#&gt; 37        1.1813119  1.274584         1.372643         1.522290</span>
<span class="co">#&gt; 38        1.1408390  1.228906         1.321395         1.462371</span>
<span class="co">#&gt; 39        1.1039719  1.187663         1.275483         1.409213</span>
<span class="co">#&gt; 40        1.0716831  1.151824         1.235865         1.363750</span>
<span class="co">#&gt; 41        1.0420845  1.119306         1.200252         1.323371</span>
<span class="co">#&gt; 42        1.0134536  1.088234         1.166607         1.285786</span>
<span class="co">#&gt; 43        0.9844489  1.057163         1.133374         1.249271</span>
<span class="co">#&gt; 44        0.9776772  1.049496         1.124750         1.239160</span>
<span class="co">#&gt; 45        0.9771523  1.048558         1.123361         1.237054</span>
<span class="co">#&gt; 46        0.9774421  1.048513         1.122949         1.236056</span>
<span class="co">#&gt; 47        0.9772808  1.048003         1.122059         1.234562</span>
<span class="co">#&gt; 48        0.9766408  1.047000         1.120661         1.232538</span>
<span class="co">#&gt; 49        0.9756779  1.045670         1.118934         1.230184</span>
<span class="co">#&gt; 50        0.9745214  1.044153         1.117026         1.227661</span>
<span class="co">#&gt;    Quantile.0.975(R)</span>
<span class="co">#&gt; 1           1.669153</span>
<span class="co">#&gt; 2           1.697568</span>
<span class="co">#&gt; 3           1.733636</span>
<span class="co">#&gt; 4           1.764508</span>
<span class="co">#&gt; 5           1.788297</span>
<span class="co">#&gt; 6           1.805900</span>
<span class="co">#&gt; 7           1.818242</span>
<span class="co">#&gt; 8           1.825922</span>
<span class="co">#&gt; 9           1.759889</span>
<span class="co">#&gt; 10          1.683750</span>
<span class="co">#&gt; 11          1.618701</span>
<span class="co">#&gt; 12          1.564278</span>
<span class="co">#&gt; 13          1.516653</span>
<span class="co">#&gt; 14          1.472800</span>
<span class="co">#&gt; 15          1.430552</span>
<span class="co">#&gt; 16          1.424341</span>
<span class="co">#&gt; 17          1.428913</span>
<span class="co">#&gt; 18          1.434335</span>
<span class="co">#&gt; 19          1.438413</span>
<span class="co">#&gt; 20          1.441220</span>
<span class="co">#&gt; 21          1.443122</span>
<span class="co">#&gt; 22          1.444404</span>
<span class="co">#&gt; 23          1.433385</span>
<span class="co">#&gt; 24          1.419892</span>
<span class="co">#&gt; 25          1.407355</span>
<span class="co">#&gt; 26          1.396139</span>
<span class="co">#&gt; 27          1.385901</span>
<span class="co">#&gt; 28          1.376309</span>
<span class="co">#&gt; 29          1.367138</span>
<span class="co">#&gt; 30          1.402564</span>
<span class="co">#&gt; 31          1.449699</span>
<span class="co">#&gt; 32          1.495289</span>
<span class="co">#&gt; 33          1.535770</span>
<span class="co">#&gt; 34          1.570562</span>
<span class="co">#&gt; 35          1.599550</span>
<span class="co">#&gt; 36          1.622682</span>
<span class="co">#&gt; 37          1.573098</span>
<span class="co">#&gt; 38          1.510192</span>
<span class="co">#&gt; 39          1.454545</span>
<span class="co">#&gt; 40          1.407078</span>
<span class="co">#&gt; 41          1.365070</span>
<span class="co">#&gt; 42          1.326143</span>
<span class="co">#&gt; 43          1.288520</span>
<span class="co">#&gt; 44          1.277896</span>
<span class="co">#&gt; 45          1.275541</span>
<span class="co">#&gt; 46          1.274337</span>
<span class="co">#&gt; 47          1.272631</span>
<span class="co">#&gt; 48          1.270390</span>
<span class="co">#&gt; 49          1.267817</span>
<span class="co">#&gt; 50          1.265081</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $method</span>
<span class="co">#&gt; [1] "parametric_si"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $si_distr</span>
<span class="co">#&gt;           t0           t1           t2           t3           t4           t5 </span>
<span class="co">#&gt; 0.000000e+00 1.155723e-01 3.184104e-01 2.491845e-01 1.500367e-01 8.209107e-02 </span>
<span class="co">#&gt;           t6           t7           t8           t9          t10          t11 </span>
<span class="co">#&gt; 4.270048e-02 2.152480e-02 1.062058e-02 5.159486e-03 2.477068e-03 1.178265e-03 </span>
<span class="co">#&gt;          t12          t13          t14          t15          t16          t17 </span>
<span class="co">#&gt; 5.562911e-04 2.610285e-04 1.218524e-04 5.663395e-05 2.622295e-05 1.210213e-05 </span>
<span class="co">#&gt;          t18          t19          t20          t21          t22          t23 </span>
<span class="co">#&gt; 5.569186e-06 2.556324e-06 1.170725e-06 5.350694e-07 2.441006e-07 1.111746e-07 </span>
<span class="co">#&gt;          t24          t25          t26          t27          t28          t29 </span>
<span class="co">#&gt; 5.055743e-08 2.295956e-08 1.041334e-08 4.717463e-09 2.134806e-09 9.651019e-10 </span>
<span class="co">#&gt;          t30          t31          t32          t33          t34          t35 </span>
<span class="co">#&gt; 4.358924e-10 1.967055e-10 8.870387e-11 3.995578e-11 1.799996e-11 8.088985e-12 </span>
<span class="co">#&gt;          t36          t37          t38          t39          t40          t41 </span>
<span class="co">#&gt; 3.641909e-12 1.628386e-12 7.317924e-13 3.257838e-13 1.427969e-13 6.613599e-14 </span>
<span class="co">#&gt;          t42          t43          t44          t45          t46          t47 </span>
<span class="co">#&gt; 2.240430e-14 2.223777e-14 8.548717e-16 0.000000e+00 0.000000e+00 0.000000e+00 </span>
<span class="co">#&gt;          t48          t49          t50          t51          t52          t53 </span>
<span class="co">#&gt; 9.092727e-15 0.000000e+00 1.654232e-14 6.994405e-16 2.331468e-16 2.331468e-16 </span>
<span class="co">#&gt;          t54          t55          t56          t57          t58          t59 </span>
<span class="co">#&gt; 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 </span>
<span class="co">#&gt;          t60          t61          t62          t63 </span>
<span class="co">#&gt; 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $SI.Moments</span>
<span class="co">#&gt;   Mean      Std</span>
<span class="co">#&gt; 1  3.1 1.652061</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dates</span>
<span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25</span>
<span class="co">#&gt; [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</span>
<span class="co">#&gt; [51] 51 52 53 54 55 56 57 58 59 60 61 62 63</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $I</span>
<span class="co">#&gt;  [1]  2.099899  2.200950  2.306865  2.417875  2.534229  2.656181  2.784001</span>
<span class="co">#&gt;  [8]  2.346946  2.459886  2.578260  2.702331  2.832373  2.968673  3.111531</span>
<span class="co">#&gt; [15]  3.308549  3.660171  4.049161  4.479493  4.955558  5.482218  6.064850</span>
<span class="co">#&gt; [22]  5.030032  5.157368  5.287927  5.421792  5.559045  5.699773  5.844063</span>
<span class="co">#&gt; [29]  5.551749  5.738013  5.930526  6.129499  6.335147  6.547694  6.767373</span>
<span class="co">#&gt; [36]  6.105405  6.210084  6.316558  6.424857  6.535013  6.647058  6.761024</span>
<span class="co">#&gt; [43]  7.807182  8.550964  9.365606 10.257858 11.235114 12.305472 13.477802</span>
<span class="co">#&gt; [50] 11.866328 12.093943 12.325925 12.562357 12.803323 13.048912 13.299212</span>
<span class="co">#&gt; [57] 12.831905 13.025835 13.222695 13.422530 13.625386 13.831307 14.040341</span></code></pre></div>
<p>The function supports forecasting for SARS-CoV2, RSV and Influenza A
and B primarily but also provides functionality to forecast other
respiratory diseases. The type of viral respiratory disease to be
forecasted can be specified by the <code>type</code> argument, which
takes in the inputs <code>rsv</code>, <code>covid</code>,
<code>flu_a</code> and <code>flu_b</code> respectively. Any other
respiratory disease can be specified by setting
<code>type = other</code>. If <code>type = other</code> is set, a
user-specified <code>mean_si</code> and <code>std_si</code> must be
passed to the function as well.</p>
</div>
<div class="section level2">
<h2 id="fitting-and-forecasting-over-sliding-windows">Fitting and forecasting over sliding windows<a class="anchor" aria-label="anchor" href="#fitting-and-forecasting-over-sliding-windows"></a>
</h2>
<p>The primary function used to fit and produce the short-term forecasts
is the <code>forecast_time_period_epiestim</code> function which wraps
the <code>fit_epiestim_model</code> function. This function can be used
to produce both daily and weekly forecasts using weekly sliding windows.
We first demonstrate how it can be used to produce daily forecasts for
14 days ahead. This is controlled by the <code>ndays = 14</code>
parameter.</p>
<p>The <code>start_date_str</code> argument should be used to specify
from which date in the dataset the forecasting should begin from. The
function automatically checks to see if the incidence count on the
specified start date is high enough to reliably estimate the
reproduction number. If this is not the case, the function throws a
warning which suggests an alternate start date.</p>
<p>The function provides progress updates as it is running about the
current time period the model is being fit for.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">time_period_result_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forecast_time_period_epiestim.html">forecast_time_period_epiestim</a></span><span class="op">(</span>data <span class="op">=</span> 
<span class="va">weekly_plover_date_type</span>, start_date_str <span class="op">=</span> <span class="st">"2022-10-02"</span>, n_days <span class="op">=</span> <span class="fl">15</span>, type <span class="op">=</span> <span class="st">"flu_a"</span><span class="op">)</span>
<span class="co">#&gt; [1] "Current time period: 1 (2022-10-09)"</span>
<span class="co">#&gt; [1] "Current time period: 2 (2022-10-16)"</span>
<span class="co">#&gt; [1] "Current time period: 3 (2022-10-23)"</span>
<span class="co">#&gt; [1] "Current time period: 4 (2022-10-30)"</span>
<span class="co">#&gt; [1] "Current time period: 5 (2022-11-06)"</span>
<span class="co">#&gt; [1] "Current time period: 6 (2022-11-13)"</span>
<span class="co">#&gt; [1] "Current time period: 7 (2022-11-20)"</span>
<span class="co">#&gt; [1] "Current time period: 8 (2022-11-27)"</span></code></pre></div>
<p>The forecasts can then be plotted at all the sliding windows used
using the <code>plot</code> function which uses the output of
<code>forecast_time_period_epiestim</code>. The function takes in an
object of of class <code>forecast_time_period_epiestim</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time_period_result_daily</span>, time_period <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<p><img src="vriforecasting-model-fitting-for-forecasts_files/figure-html/unnamed-chunk-6-1.png" width="70%"></p>
<p>We can also produce forecasts aggregated by week by setting
<code>aggregate_week = TRUE</code>. For the functionality,
<code>n_days</code> must be a multiple of 7. Thus, specifying
<code>n_days = 14</code> when <code>aggregate_week = TRUE</code>
produces 14/7 i.e. 2-week ahead forecasts.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">time_period_result_weekly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forecast_time_period_epiestim.html">forecast_time_period_epiestim</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">weekly_plover_date_type</span>, 
start_date_str <span class="op">=</span> <span class="st">"2022-10-02"</span>, n_days <span class="op">=</span> <span class="fl">14</span>, type <span class="op">=</span> <span class="st">"flu_a"</span>,  aggregate_week <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] "Current time period: 1 (2022-10-09)"</span>
<span class="co">#&gt; [1] "Current time period: 2 (2022-10-16)"</span>
<span class="co">#&gt; [1] "Current time period: 3 (2022-10-23)"</span>
<span class="co">#&gt; [1] "Current time period: 4 (2022-10-30)"</span>
<span class="co">#&gt; [1] "Current time period: 5 (2022-11-06)"</span>
<span class="co">#&gt; [1] "Current time period: 6 (2022-11-13)"</span>
<span class="co">#&gt; [1] "Current time period: 7 (2022-11-20)"</span>
<span class="co">#&gt; [1] "Current time period: 8 (2022-11-27)"</span></code></pre></div>
<p>Optionally, one can also choose to plot the forecast for a single
time period by specifying the time period using the
<code>time_period</code> argument:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time_period_result_weekly</span>, time_period <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="vriforecasting-model-fitting-for-forecasts_files/figure-html/unnamed-chunk-8-1.png" width="80%"></p>
<p>Finally, we can plot a validation violin plot using the
<code>plotValidation</code> function. Currently, this plot supports only
weekly forecasted data. We can plot 1 week ahead forecasts for example
by setting the <code>pred_horizon</code> argument. The function can
produce either a <code>violin</code> or <code>ribbon</code> plot, which
can be controlled by the <code>pred_plot</code> argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotValidation.html">plotValidation</a></span><span class="op">(</span><span class="va">time_period_result_weekly</span>, pred_horizon_str <span class="op">=</span> <span class="st">"2 week ahead"</span>, pred_plot <span class="op">=</span> <span class="st">"ribbon"</span><span class="op">)</span></code></pre></div>
<p><img src="vriforecasting-model-fitting-for-forecasts_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotValidation.html">plotValidation</a></span><span class="op">(</span><span class="va">time_period_result_weekly</span>, pred_horizon_str <span class="op">=</span> <span class="st">"1 week ahead"</span>, pred_plot <span class="op">=</span> <span class="st">"ribbon"</span><span class="op">)</span></code></pre></div>
<p><img src="vriforecasting-model-fitting-for-forecasts_files/figure-html/unnamed-chunk-10-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The object of class <code>forecast_time_period_epiestim</code>
produced by the <code>forecast_time_period_epiestim</code> function also
has a customized <code>summary</code> function. This function checks to
see if the weekly data inputted fall into the ranges of the prediction
quantiles and issues a warning if this is not the case. This can be a
useful check to assess the forecasts produced and the model fit along
with the validation plot. It takes in the same arguments as the
<code>plotValidation</code> function above:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">time_period_result_weekly</span>, pred_horizon_str <span class="op">=</span> <span class="st">"2 week ahead"</span><span class="op">)</span>
<span class="co">#&gt; Warning in summary.forecast_time_period_epiestim(time_period_result_weekly, :</span>
<span class="co">#&gt; Prediction percentile intervals do not cover some data-points in validation</span>
<span class="co">#&gt; fits. Some forecasts may not be reliable</span>
<span class="co">#&gt; $individual_quantiles</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="co">#&gt; <span style="color: #949494;"># Groups:   weekly_date [6]</span></span>
<span class="co">#&gt;   weekly_date coverage                   weighted_diff confirm median.prediction</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2022-10-23  50 and 95 percentile inte…          588       38               24 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2022-10-30  only 95 percentile interv…        <span style="text-decoration: underline;">13</span>467       43              110 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2022-11-06  50 and 95 percentile inte…           12       45               43 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2022-11-13  50 and 95 percentile inte…          432       73               61 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2022-11-20  only 95 percentile interv…         <span style="text-decoration: underline;">3</span>888       88               52 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2022-11-27  Outside 95 percentile int…        <span style="text-decoration: underline;">65</span>269.      94              242.</span>
<span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: `50 percentile interval` &lt;glue&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   `95 percentile interval` &lt;glue&gt;</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $quantile_summary</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="co">#&gt;   coverage                       count</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 50 and 95 percentile interval      3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Outside 95 percentile interval     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> only 95 percentile interval        2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $time_weighted_mspe</span>
<span class="co">#&gt; [1] 118.0789</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Mike Irvine, Caesar Wong, Nirupama Tamvada.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
